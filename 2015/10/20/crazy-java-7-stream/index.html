<!DOCTYPE html><html><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="java"><title>7.《疯狂Java讲义第三版》读书笔记-Stream | CHILAM</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">7.《疯狂Java讲义第三版》读书笔记-Stream</h1><a id="logo" href="/.">CHILAM</a><p class="description">Just Do IT</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> Start</i></a><a href="/archives/"><i class="fa fa-archive"> Archiv</i></a><a href="/about/"><i class="fa fa-user"> Über</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">7.《疯狂Java讲义第三版》读书笔记-Stream</h1><div class="post-meta">Oct 20, 2015<span> | </span><span class="category"><a href="/categories/搬砖/">搬砖</a></span><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><span id="busuanzi_container_page_pv"> | <span id="busuanzi_value_page_pv"></span><span> Hits</span></span><span class="post-time"><span class="post-meta-item-text"> | </span><span class="post-meta-item-icon"><i class="fa fa-keyboard-o"></i><span class="post-count"> 1,459</span><span class="post-meta-item-text"> Words</span></span></span><span class="post-time"> | <span class="post-meta-item-icon"><i class="fa fa-hourglass-half"></i><span class="post-count"> 7</span><span class="post-meta-item-text"> Minutes</span></span></span></div><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">Inhalte</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#流的定义"><span class="toc-number">1.</span> <span class="toc-text">流的定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#从迭代器到Stream操作"><span class="toc-number">2.</span> <span class="toc-text">从迭代器到Stream操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#迭代访问"><span class="toc-number">2.1.</span> <span class="toc-text">迭代访问</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stream访问操作"><span class="toc-number">2.2.</span> <span class="toc-text">Stream访问操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Stream与集合的差别"><span class="toc-number">2.3.</span> <span class="toc-text">Stream与集合的差别</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#构建Stream"><span class="toc-number">3.</span> <span class="toc-text">构建Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#创建无限流"><span class="toc-number">3.1.</span> <span class="toc-text">创建无限流</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用Stream"><span class="toc-number">4.</span> <span class="toc-text">使用Stream</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#筛选与切片"><span class="toc-number">4.1.</span> <span class="toc-text">筛选与切片</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#映射"><span class="toc-number">4.2.</span> <span class="toc-text">映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#查找和匹配"><span class="toc-number">4.3.</span> <span class="toc-text">查找和匹配</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#规约"><span class="toc-number">4.4.</span> <span class="toc-text">规约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数值流"><span class="toc-number">4.5.</span> <span class="toc-text">数值流</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#数值范围"><span class="toc-number">4.6.</span> <span class="toc-text">数值范围</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#使用流收集数据"><span class="toc-number">5.</span> <span class="toc-text">使用流收集数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#预定义的收集器"><span class="toc-number">5.1.</span> <span class="toc-text">预定义的收集器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#规约和汇总"><span class="toc-number">5.2.</span> <span class="toc-text">规约和汇总</span></a></li></ol></li></ol></div></div><div class="post-content"><h2 id="流的定义"><a href="#流的定义" class="headerlink" title="流的定义"></a>流的定义</h2><p>从支持数据处理操作的源生成的元素序列</p>
<ul>
<li>元素序列，集合是数据结构，它的主要目的是以特定的时间和空间复杂度存储和访问元素，流的主要目的是表达计算。</li>
<li>源，流会使用一个提供数据的源，比如集合，数组或输入输出资源</li>
<li>数据处理操作，流的数据处理能力支持类似于数据库的操作</li>
<li>流水线，很多流操作本身会返回一个流</li>
<li>内部迭代,不是强制的使用的外部迭代</li>
</ul>
<h2 id="从迭代器到Stream操作"><a href="#从迭代器到Stream操作" class="headerlink" title="从迭代器到Stream操作"></a>从迭代器到Stream操作</h2><h3 id="迭代访问"><a href="#迭代访问" class="headerlink" title="迭代访问"></a>迭代访问</h3><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//迭代方式统计文本中长单词</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> iterator() throws IOException &#123;</span><br><span class="line">    <span class="keyword">String</span> content = <span class="keyword">new</span> <span class="keyword">String</span>(Files.readAllBytes(Paths.<span class="built_in">get</span>(<span class="string">"f:"</span>,<span class="string">"images"</span>,<span class="string">"topic.txt"</span>)), StandardCharsets.UTF_8);</span><br><span class="line">    List&lt;<span class="keyword">String</span>&gt; words = Arrays.asList(content.split(<span class="string">"[\\P&#123;L&#125;]+"</span>));</span><br><span class="line">    <span class="keyword">long</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">for</span> (<span class="keyword">String</span> <span class="keyword">word</span> : words) &#123;</span><br><span class="line">        <span class="built_in">if</span> (<span class="keyword">word</span>.length() &gt; <span class="number">7</span>) &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Stream访问操作"><a href="#Stream访问操作" class="headerlink" title="Stream访问操作"></a>Stream访问操作</h3><figure class="highlight processing"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//stream方式统计文本中长单词</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">long</span> stream() <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">String</span> content = <span class="keyword">new</span> <span class="keyword">String</span>(Files.readAllBytes(Paths.<span class="built_in">get</span>(<span class="string">"f:"</span>,<span class="string">"images"</span>,<span class="string">"topic.txt"</span>)), StandardCharsets.UTF_8);</span><br><span class="line">    List&lt;<span class="keyword">String</span>&gt; words = Arrays.asList(content.<span class="built_in">split</span>(<span class="string">"[\\P&#123;L&#125;]+"</span>));</span><br><span class="line">    <span class="keyword">return</span> words.stream().<span class="built_in">filter</span>(s -&gt; s.length() &gt; <span class="number">7</span>).count();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Stream与集合的差别"><a href="#Stream与集合的差别" class="headerlink" title="Stream与集合的差别"></a>Stream与集合的差别</h3><ul>
<li>Stream不会存储元素，元素可能被存储在底层的集合中，或者根据需要产生出来。</li>
<li>Stream操作符不会改变原对象，会返回一个持有结果的新Stream。</li>
<li>Stream操作符可能延迟执行，意味着他们会等到需要结果的时候才会执行。</li>
</ul>
<h2 id="构建Stream"><a href="#构建Stream" class="headerlink" title="构建Stream"></a>构建Stream</h2><ul>
<li>Stream.of()，由值创建流</li>
<li>Stream.empty()，创建一个空流</li>
<li>Array.stream()，由数组创建流</li>
<li>Files.lines(),文件创建流</li>
</ul>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> createStream() &#123;</span><br><span class="line">    <span class="built_in">Stream</span>&lt;<span class="keyword">String</span>&gt; stringStream = <span class="built_in">Stream</span>.of(<span class="string">"sss"</span>, <span class="string">"xxx"</span>, <span class="string">"cvcv"</span>);</span><br><span class="line">    <span class="built_in">Stream</span>&lt;Object&gt; empty = <span class="built_in">Stream</span>.empty();</span><br><span class="line">    IntStream intStream = Arrays.stream(<span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">34</span>, <span class="number">5</span>, <span class="number">67</span>, <span class="number">8</span>, <span class="number">8</span>, <span class="number">9</span>&#125;);</span><br><span class="line">    <span class="built_in">Stream</span>&lt;Double&gt; doubleStream = <span class="built_in">Stream</span>.generate(Math::<span class="built_in">random</span>);</span><br><span class="line">    <span class="comment">//获取的文件的内容流</span></span><br><span class="line">    <span class="built_in">try</span> (<span class="built_in">Stream</span>&lt;<span class="keyword">String</span>&gt; lines = Files.lines(Paths.<span class="built_in">get</span>(<span class="string">""</span>))) &#123;</span><br><span class="line"></span><br><span class="line">    &#125; <span class="built_in">catch</span> (IOException ioe) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="创建无限流"><a href="#创建无限流" class="headerlink" title="创建无限流"></a>创建无限流</h3><ul>
<li>迭代</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//iterate方法接收一个初始值，还有一个依次应用在每个产生新值的lambda</span></span><br><span class="line"><span class="selector-tag">Stream</span><span class="selector-class">.iterate</span>(<span class="number">0</span>, n -&gt; n + <span class="number">2</span>)<span class="selector-class">.limit</span>(<span class="number">10</span>)<span class="selector-class">.forEach</span>(System.<span class="attribute">out</span>::print);</span><br></pre></td></tr></table></figure>
<ul>
<li>生成</li>
</ul>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接受一个Lambda的表达式</span></span><br><span class="line"><span class="selector-tag">Stream</span><span class="selector-class">.generate</span>(<span class="attribute">Math</span>::random)<span class="selector-class">.limit</span>(<span class="number">5</span>)<span class="selector-class">.forEach</span>(System.<span class="attribute">err</span>::print);</span><br></pre></td></tr></table></figure>
<h2 id="使用Stream"><a href="#使用Stream" class="headerlink" title="使用Stream"></a>使用Stream</h2><h3 id="筛选与切片"><a href="#筛选与切片" class="headerlink" title="筛选与切片"></a>筛选与切片</h3><figure class="highlight xl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; integerList = Arrays.asList(<span class="number">1</span>, <span class="number">24</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">12</span>, <span class="number">12</span>, <span class="number">45</span>, <span class="number">23</span>, <span class="number">0</span>, <span class="number">112</span>, <span class="number">456</span>);</span><br><span class="line"><span class="comment">//1.filter()方法接受一个谓词（一个boolean的函数）作为参数，返回符合谓词元素的流</span></span><br><span class="line"><span class="function"><span class="title">integerList</span>.stream().filter(i -&gt;</span> i &gt; <span class="number">10</span>).forEach(System.out::println);</span><br><span class="line"><span class="comment">//2.distinct()返回一个元素(根据流所生成的元素的hashCode和equals方法实现)各异的流</span></span><br><span class="line"><span class="function"><span class="title">integerList</span>.stream().filter(i -&gt;</span> i &gt; <span class="number">10</span>).distinct().forEach(System.err::println);</span><br><span class="line"><span class="comment">//3.limit()截断流，该方法返回一个不超过给定长度的流</span></span><br><span class="line"><span class="function"><span class="title">integerList</span>.stream().filter(<span class="keyword">integer</span> -&gt;</span> <span class="keyword">integer</span> &gt; <span class="number">10</span>).limit(<span class="number">3</span>).forEach(System.out::println);</span><br><span class="line"><span class="comment">//4.skip(n)跳过元素,返回一个扔掉前n个元素的流</span></span><br><span class="line"><span class="function"><span class="title">integerList</span>.stream().filter(<span class="keyword">integer</span> -&gt;</span> <span class="keyword">integer</span> &gt; <span class="number">10</span>).skip(<span class="number">3</span>).forEach(System.err::println);</span><br></pre></td></tr></table></figure>
<h3 id="映射"><a href="#映射" class="headerlink" title="映射"></a>映射</h3><ul>
<li>对流中的每一个元素进行处理</li>
</ul>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">List</span>&lt;<span class="built_in">String</span>&gt; stringList = Arrays.asList(<span class="string">"xxx"</span>, <span class="string">"simon"</span>, <span class="string">"john"</span>, <span class="string">"ele"</span>, <span class="string">"alala"</span>);</span><br><span class="line">stringList.stream().<span class="built_in">map</span>(s -&gt; s.length()).forEach(System.out<span class="type">::println</span>);</span><br></pre></td></tr></table></figure>
<ul>
<li>流的扁平化</li>
</ul>
<p>flapMap方法让你把一个流中的每个值都换成了另外一个流，然后把所有的流连接起来成为一个流。</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">List</span>&lt;<span class="keyword">String</span>&gt; strings = <span class="keyword">Arrays</span>.asList(<span class="string">"hello"</span>, <span class="string">"world"</span>);</span><br><span class="line">strings.stream().</span><br><span class="line">        map(s -&gt; s.split(<span class="string">""</span>))</span><br><span class="line">        .flatMap(<span class="keyword">Arrays</span>::stream)//<span class="keyword">List</span>&lt;<span class="keyword">String</span>[]&gt;-&gt;<span class="keyword">List</span>&lt;<span class="keyword">String</span>&gt;</span><br><span class="line">        .distinct()</span><br><span class="line">        .collect(Collectors.toList())</span><br><span class="line">        .forEach(System.out::println);</span><br></pre></td></tr></table></figure>
<h3 id="查找和匹配"><a href="#查找和匹配" class="headerlink" title="查找和匹配"></a>查找和匹配</h3><ul>
<li>检查谓词是否至少匹配一个元素anyMatch,返回boolean值是个终端方法</li>
</ul>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">List</span>&lt;<span class="keyword">String&gt; </span><span class="keyword">stringList </span>= Arrays.asList(<span class="string">"john"</span>, <span class="string">"simon"</span>, <span class="string">"david"</span>, <span class="string">"ziuoluo"</span>)<span class="comment">;</span></span><br><span class="line"><span class="keyword">boolean </span>anyMatch = <span class="keyword">stringList.stream().anyMatch(s </span>-&gt; s.equals(<span class="string">"john"</span>))<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>检查谓词是否匹配所有元素allMatch</li>
</ul>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">List</span>&lt;<span class="keyword">String&gt; </span><span class="keyword">stringList </span>= Arrays.asList(<span class="string">"john"</span>, <span class="string">"simon"</span>, <span class="string">"david"</span>, <span class="string">"ziuoluo"</span>)<span class="comment">;</span></span><br><span class="line"><span class="keyword">boolean </span><span class="keyword">b </span>= <span class="keyword">stringList.stream().allMatch(s </span>-&gt; s.length() &gt; <span class="number">4</span>)<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>确保流中没有任何元素与给定的谓词匹配noneMatch</li>
</ul>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">List</span>&lt;<span class="keyword">String&gt; </span><span class="keyword">stringList </span>= Arrays.asList(<span class="string">"john"</span>, <span class="string">"simon"</span>, <span class="string">"david"</span>, <span class="string">"ziuoluo"</span>)<span class="comment">;</span></span><br><span class="line"><span class="keyword">boolean </span><span class="keyword">b1 </span>= <span class="keyword">stringList.stream().noneMatch(s </span>-&gt; s.length() &gt; <span class="number">4</span>)<span class="comment">;</span></span><br><span class="line"><span class="symbol">System.out.println</span>(<span class="string">"b1 = "</span> + <span class="keyword">b1);</span></span><br></pre></td></tr></table></figure>
<ul>
<li>查找元素findAny,返回当前流的中任意元素</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">List</span>&lt;<span class="keyword">String</span>&gt; stringList = <span class="keyword">Arrays</span>.asList(<span class="string">"john"</span>, <span class="string">"simon"</span>, <span class="string">"david"</span>, <span class="string">"ziuoluo"</span>);</span><br><span class="line"><span class="keyword">Optional</span>&lt;<span class="keyword">String</span>&gt; any = stringList.stream().filter(s -&gt; s.length() &gt; <span class="number">4</span>).findAny();</span><br><span class="line">System.out.println(<span class="string">"any.get() = "</span> + any.get());</span><br></pre></td></tr></table></figure>
<ul>
<li>查找第一个元素findFirst</li>
</ul>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">Optional</span>&lt;<span class="keyword">String&gt; </span>first = <span class="keyword">stringList.stream().filter(s </span>-&gt; s.length() &gt; <span class="number">4</span>).findFirst()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h3 id="规约"><a href="#规约" class="headerlink" title="规约"></a>规约</h3><ul>
<li><p>元素求和reduce</p>
<figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; integerList = Arrays.asList(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>);</span><br><span class="line">Optional&lt;Integer&gt; reduce = integerList.stream<span class="function"><span class="params">()</span>.<span class="title">reduce</span><span class="params">((a, b) -&gt; a + b)</span>;//求和 1+2+3+4+5+6</span></span><br><span class="line"><span class="function"><span class="title">System</span>.<span class="title">out</span>.<span class="title">println</span><span class="params">(<span class="string">"reduce.get() = "</span> + reduce.get())</span>;</span></span><br><span class="line"><span class="function"><span class="title">Optional</span>&lt;<span class="title">Integer</span>&gt; <span class="title">reduce4</span> = <span class="title">integerList</span>.<span class="title">stream</span><span class="params">()</span>.<span class="title">reduce</span><span class="params">(Integer::sum)</span>;</span></span><br><span class="line"><span class="function"><span class="title">Optional</span>&lt;<span class="title">Integer</span>&gt; <span class="title">reduce1</span> = <span class="title">integerList</span>.<span class="title">stream</span><span class="params">()</span>.<span class="title">reduce</span><span class="params">((a, b) -&gt; a * b)</span>;</span></span><br><span class="line"><span class="function"><span class="title">System</span>.<span class="title">out</span>.<span class="title">println</span><span class="params">(<span class="string">"reduce1 = "</span> + reduce1.get())</span>;//1*2*3*4*5*6</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>最大值</p>
</li>
</ul>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Optional</span>&lt;<span class="keyword">Integer</span>&gt; reduce2 = integerList.stream().reduce(<span class="keyword">Integer</span>::<span class="built_in">max</span>);</span><br><span class="line">System.<span class="keyword">out</span>.println(<span class="string">"reduce2.get() = "</span> + reduce2.get());</span><br></pre></td></tr></table></figure>
<ul>
<li>最小值</li>
</ul>
<figure class="highlight fortran"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Optional</span>&lt;<span class="keyword">Integer</span>&gt; reduce3 = integerList.stream().reduce(<span class="keyword">Integer</span>::<span class="built_in">min</span>);</span><br><span class="line">System.<span class="keyword">out</span>.println(<span class="string">"reduce3.get() = "</span> + reduce3.get())</span><br></pre></td></tr></table></figure>
<h3 id="数值流"><a href="#数值流" class="headerlink" title="数值流"></a>数值流</h3><p>java8引入了3个原始类型特化流来处理数值流问题。</p>
<ul>
<li>java.util.stream.IntStream</li>
<li>java.util.stream.DoubleStream</li>
<li>java.util.stream.LongStream</li>
</ul>
<p>分别将流中的包装类型元素转换成int,double,long，从而避免暗含的装箱操作</p>
<figure class="highlight gams"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">List&lt;<span class="keyword">Integer</span>&gt; integers = Arrays.asList(<span class="number">1</span>, <span class="number">45</span>, <span class="number">355</span>, <span class="number">67</span>, <span class="number">45</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">44</span>, <span class="number">7</span>);</span><br><span class="line"><span class="keyword">Integer</span> reduce = integers.stream().reduce(<span class="number">0</span>, <span class="keyword">Integer</span>::<span class="keyword">sum</span>);<span class="comment">//有暗含的装箱成本</span></span><br><span class="line"><span class="keyword">System</span>.out.println(<span class="string">"reduce = "</span> + reduce);</span><br><span class="line"><span class="comment">//mapToInt转换成数值流</span></span><br><span class="line">int <span class="keyword">sum</span> = integers.stream().mapToInt(<span class="keyword">Integer</span>::intValue).<span class="keyword">sum</span>();</span><br><span class="line"><span class="keyword">System</span>.out.println(<span class="string">"sum = "</span> + <span class="keyword">sum</span>);</span><br></pre></td></tr></table></figure>
<h3 id="数值范围"><a href="#数值范围" class="headerlink" title="数值范围"></a>数值范围</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">IntStream.rangeClosed(1, 100).<span class="keyword">forEach</span>(System.<span class="keyword">out</span>::<span class="keyword">print</span>);<span class="comment">//包含结束值</span></span><br><span class="line">IntStream.<span class="keyword">range</span>(1, 100).<span class="keyword">forEach</span>(System.<span class="keyword">err</span>::<span class="keyword">print</span>);<span class="comment">//不包含结束值</span></span><br></pre></td></tr></table></figure>
<h2 id="使用流收集数据"><a href="#使用流收集数据" class="headerlink" title="使用流收集数据"></a>使用流收集数据</h2><h3 id="预定义的收集器"><a href="#预定义的收集器" class="headerlink" title="预定义的收集器"></a>预定义的收集器</h3><ul>
<li>将流元素规约和汇总为一个值</li>
<li>元素分组</li>
<li>元素分区</li>
</ul>
<h3 id="规约和汇总"><a href="#规约和汇总" class="headerlink" title="规约和汇总"></a>规约和汇总</h3><figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; integers = Arrays.<span class="keyword">asList</span>(<span class="number">1</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">67</span>, <span class="number">8</span>, <span class="number">909</span>);</span><br><span class="line"><span class="keyword">Long</span> <span class="keyword">collect</span> = integers.stream().<span class="keyword">collect</span>(Collectors.counting());</span><br><span class="line"><span class="keyword">long</span> <span class="keyword">count</span> = integers.stream().<span class="keyword">count</span>();</span><br><span class="line">Comparator&lt;Integer&gt; comparator = <span class="keyword">new</span> Comparator&lt;Integer&gt;() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span> compare(Integer o1, Integer o2) &#123;</span><br><span class="line">        <span class="keyword">return</span> o1 &gt; o2 ? <span class="number">1</span> : -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Optional&lt;Integer&gt; collect1 = integers.stream().<span class="keyword">collect</span>(Collectors.maxBy(comparator));</span><br><span class="line">System.out.<span class="keyword">println</span>(<span class="string">"collect1.get() = "</span> + collect1.get());</span><br></pre></td></tr></table></figure>
<ul>
<li>连接字符串</li>
</ul>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">List</span>&lt;<span class="keyword">String</span>&gt; strings = <span class="keyword">Arrays</span>.asList(<span class="string">"xxx"</span>, <span class="string">"ttt"</span>, <span class="string">"zzz"</span>);</span><br><span class="line"><span class="keyword">String</span> collect2 = strings.stream().collect(Collectors.joining(<span class="string">","</span>));</span><br><span class="line">System.out.println(<span class="string">"collect2 = "</span> + collect2);</span><br></pre></td></tr></table></figure>
</div><script type="text/javascript" src="/js/share.js?v=0.0.0" async></script><a class="article-share-link" data-url="http://chilam.me/2015/10/20/crazy-java-7-stream/" data-id="cjkv44heq001g4b8kyq1hyxbk" data-qrcode="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMYAAADGCAAAAACs8KCBAAACLUlEQVR42u3aS5LCMAxFUfa/6fSUAXbuk2iqIt+MKCDBh4FKv9cLX9fbtfp0/87q0/Te1iVDhozHMq7ttfpO+sPkjyC/u3yODBkyDmDUwuL+fQ7eM0iIlyFDhgweUr97RBkyZMioPY4cl4TpfSIoQ4YMGbUilqeGKXL/+su1uAwZMh7I4F3337/+l/mGDBkyHsW4wmsfOmttfZ4+Lp8jQ4aM0YzaAJIHxH3i2Am4MmTIOIeRNrzIsTrPJPd+OIkMGTJGM/hR+IF4kE2XM25+S4YMGccwOqsSaXOfJJHkbDJkyJjN2H+1kxTyBhyn3oRaGTJkDGX0A2VtwthZAlueQYYMGQcw0rZXLbB2wjfKcGXIkDGUwRcjSCjkzX1esgYlrgwZMsYx+qNK8kfwv4Af/WayIUOGjEEMUnDyhI8PEtLQHBfPMmTIGMTgSr4w0dnU4osdH0aYMmTIGMr4TeOMg3moDapwGTJkjGDw2zrU2rAhbczJkCHjBEaw3BDySMLHB6UyZMg4jcEP3UkH04DO975kyJBxDoOPJGvhuLZ4ERS9MmTIOIDRL2jTYF27F22OyJAhYxDjCq/O0ka/ebc8gwwZMkYzasfin3Za/2l5LEOGjNmMWrFKmvv90leGDBkyeBHLh45puy1NPVu1uAwZMo5hpKPHGiDOZ2XIkCGjkRqSME3ac18YYcqQIePhjLRZnyJrC2dB+0+GDBmjGfy2NO3rDxtqCasMGTIGMf4A1gzbGR52DVEAAAAASUVORK5CYII=">Aktie</a><div class="tags"><a href="/tags/java/">java</a></div><div class="post-nav"><a class="pre" href="/2015/10/20/crazy-java-8-forkandjoin/">8.《疯狂Java讲义第三版》读书笔记-forkandjoin</a><a class="next" href="/2015/10/18/crazy-java-6-lambda/">6.《疯狂Java讲义第三版》读书笔记-lambda</a></div><div id="container"></div><link rel="stylesheet" href="/css/default.css?v=0.0.0"><script src="/js/gitment.browser.js?v=0.0.0"></script><script>var gitment = new Gitment({
  owner: 'CasperMXP',
  repo: 'CasperMXP.github.io',
  oauth: {
    client_id: '2cf162fa015e397bb3c9',
    client_secret: '9c97449f4ec96ac4a1064e819e92fde840e66ec7',
  },
})
gitment.render('container')
</script></div></div></div><div class="pure-u-1 pure-u-md-1-4"><div id="sidebar"><div class="widget"><div class="search-form"><input id="local-search-input" placeholder="Search" type="text" name="q" results="0"/><div id="local-search-result"></div></div></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> Kategorien</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/1房2人3餐4季/">1房2人3餐4季</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/搬砖/">搬砖</a><span class="category-list-count">98</span></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> Tags</i></div><div class="tagcloud"><a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/bable/" style="font-size: 15px;">bable</a> <a href="/tags/java/" style="font-size: 15px;">java</a> <a href="/tags/design-pattern/" style="font-size: 15px;">design-pattern</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/dva/" style="font-size: 15px;">dva</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/hibernate/" style="font-size: 15px;">hibernate</a> <a href="/tags/hystrix/" style="font-size: 15px;">hystrix</a> <a href="/tags/Hystrix/" style="font-size: 15px;">Hystrix</a> <a href="/tags/ibatis/" style="font-size: 15px;">ibatis</a> <a href="/tags/idea/" style="font-size: 15px;">idea</a> <a href="/tags/spring/" style="font-size: 15px;">spring</a> <a href="/tags/test/" style="font-size: 15px;">test</a> <a href="/tags/modules/" style="font-size: 15px;">modules</a> <a href="/tags/javaweb/" style="font-size: 15px;">javaweb</a> <a href="/tags/jmm/" style="font-size: 15px;">jmm</a> <a href="/tags/jvm/" style="font-size: 15px;">jvm</a> <a href="/tags/life/" style="font-size: 15px;">life</a> <a href="/tags/links/" style="font-size: 15px;">links</a> <a href="/tags/cache/" style="font-size: 15px;">cache</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/logback/" style="font-size: 15px;">logback</a> <a href="/tags/markdown/" style="font-size: 15px;">markdown</a> <a href="/tags/maths/" style="font-size: 15px;">maths</a> <a href="/tags/maven/" style="font-size: 15px;">maven</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/node/" style="font-size: 15px;">node</a> <a href="/tags/nodejs/" style="font-size: 15px;">nodejs</a> <a href="/tags/react-router/" style="font-size: 15px;">react-router</a> <a href="/tags/react/" style="font-size: 15px;">react</a> <a href="/tags/redux/" style="font-size: 15px;">redux</a> <a href="/tags/html/" style="font-size: 15px;">html</a> <a href="/tags/spring-boot/" style="font-size: 15px;">spring-boot</a> <a href="/tags/security/" style="font-size: 15px;">security</a> <a href="/tags/sublime/" style="font-size: 15px;">sublime</a> <a href="/tags/javaee/" style="font-size: 15px;">javaee</a> <a href="/tags/weblogic/" style="font-size: 15px;">weblogic</a> <a href="/tags/webpack/" style="font-size: 15px;">webpack</a> <a href="/tags/win10/" style="font-size: 15px;">win10</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> Letzte</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/15/dva/">dva</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/15/redux/">redux</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/15/router-history-hash/">前端路由的实现原理-history,hash</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/14/react-router/">react-router</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/13/webpack/">webpack</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/13/javascript-modules/">前端模块化</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/11/react/">react</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/11/babel/">babel</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/11/nodejs/">nodejs</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/06/20/interview-2/">2.面试准备-框架</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">CHILAM.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/search.js?v=0.0.0"></script><script>var search_path = 'search.xml';
if (search_path.length == 0) {
   search_path = 'search.xml';
}
var path = '/' + search_path;
searchFunc(path, 'local-search-input', 'local-search-result');
</script><script type="text/javascript" color="100,99,98" opacity="0.7" zIndex="-1" count="30" src="//cdn.bootcss.com/canvas-nest.js/1.0.1/canvas-nest.min.js"></script><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>